clear all
close all
%
rho_sim = 0:.1:1;
rho_ana = 0:.01:1;
%
OP_N_non_sim = ones(1,length(rho_sim))*0.029147000000000;
OP_F_non_sim = ones(1,length(rho_sim))*0.131223000000000;
%
OP_N_sim = [0.0852200000000000,0.0933310000000000,0.103576000000000,0.116527000000000,0.133861000000000,0.155927000000000,0.189870000000000,0.243094000000000,0.338910000000000,0.557537000000000,1];
OP_N_exact = [0.0852459064088300,0.0859940354817768,0.0867568017855507,0.0875346388587683,0.0883279975203715,0.0891373467386325,0.0899631745530944,0.0908059890532401,0.0916663194180039,0.0925447170205802,0.0934417566033611,0.0943580375282459,0.0952941851080214,0.0962508520250029,0.0972287198436813,0.0982285006247099,0.0992509386482402,0.100296812255334,0.101366935816991,0.102462161841220,0.103583383229558,0.104731535695551,0.105907600358885,0.107112606530236,0.108347634703360,0.109613819772629,0.110912354496049,0.112244493225860,0.113611555931118,0.115014932539241,0.116456087626347,0.117936565489494,0.119457995637520,0.121022098741282,0.122630693088675,0.124285701595030,0.125989159425321,0.127743222291266,0.129550175493942,0.131412443791055,0.133332602177775,0.135313387681098,0.137357712280408,0.139468677081360,0.141649587886889,0.143903972328198,0.146235598740609,0.148648496994531,0.151146981521159,0.153735676806523,0.156419545667092,0.159203920666133,0.162094539083834,0.165097581917150,0.168219717459210,0.171468150095107,0.174850675053576,0.178375739975567,0.182052514305062,0.185890967679362,0.189901958701407,0.194097335722945,0.198490051563416,0.203094294446907,0.207925637872403,0.213001212658906,0.218339905049223,0.223962585542836,0.229892374095561,0.236154948517632,0.242778904381458,0.249796176590883,0.257242535062272,0.265158169848278,0.273588384657386,0.282584422290525,0.292204451290109,0.302514750404442,0.313591136715901,0.325520694947796,0.338403880092233,0.352357083612290,0.367515775377626,0.384038358842225,0.402110903745908,0.421952942925519,0.443824523090016,0.468034649859736,0.494951088529585,0.525011001545261,0.558730729867577,0.596710252924105,0.639621351896916,0.688153081416056,0.742851104003984,0.803697805805281,0.869070988551486,0.933336653177190,0.982718176594127,0.999698909598169,1];
%
OP_F_sim = [0.431545000000000,0.0662130000000000,0.0457660000000000,0.0390240000000000,0.0369880000000000,0.0386660000000000,0.0429010000000000,0.0515000000000000,0.0713520000000000,0.130013000000000,1];
OP_F_exact = [0.431554592826074,0.230013714710746,0.165236643667002,0.133010360651408,0.113149760890480,0.0994850574618457,0.0894257947572389,0.0816742972638625,0.0755013886175762,0.0704625492239033,0.0662697287151296,0.0627271919632579,0.0596967889736293,0.0570779449543981,0.0547955312876828,0.0527921968448404,0.0510233437214109,0.0494537338261010,0.0480551359133114,0.0468046562228277,0.0456835300114622,0.0446762309832929,0.0437698044796238,0.0429533610514473,0.0422176868823594,0.0415549406151901,0.0409584149358122,0.0404223472931481,0.0399417683282879,0.0395123795488147,0.0391304539072219,0.0387927544825497,0.0384964675952983,0.0382391475252481,0.0380186706316150,0.0378331971520169,0.0376811393214749,0.0375611347340322,0.0374720240885383,0.0374128326320151,0.0373827547501307,0.0373811412630878,0.0374074890730536,0.0374614328809295,0.0375427387495158,0.0376512993398485,0.0377871306899504,0.0379503704422921,0.0381412774593881,0.0383602327974442,0.0386077420369346,0.0388844389974274,0.0391910908928856,0.0395286050140000,0.0398980370569252,0.0403006012541947,0.0407376825049248,0.0412108507491953,0.0417218778875872,0.0422727576135548,0.0428657286064532,0.0435033016302410,0.0441882912017088,0.0449238526384534,0.0457135254783341,0.0465612844888062,0.0474715997693939,0.0484495078110329,0.0495006958352465,0.0506316023253321,0.0518495374233362,0.0531628278586050,0.0545809923764387,0.0561149553609667,0.0577773086530780,0.0595826346780135,0.0615479082444523,0.0636930002352245,0.0660413145877801,0.0686206015272928,0.0714640065993812,0.0746114391945228,0.0781113799939365,0.0820233006245796,0.0864209515967474,0.0913969046522952,0.0970689449556505,0.103589254586797,0.111157918368462,0.120043322386939,0.130613920140337,0.143389490255507,0.159127371498063,0.178974941360476,0.204755959662649,0.239549748260963,0.288977236060816,0.364415769443143,0.492265954999134,0.741342705585336,NaN];
OP_F_approx = [Inf,0.686872168693144,0.350169719081293,0.238023568791121,0.182018589760807,0.148471827318352,0.126155692167110,0.110258416557104,0.0983741684910486,0.0891664232825377,0.0818333123307677,0.0758645999847736,0.0709201721224116,0.0667646070700750,0.0632297877037933,0.0601924688583084,0.0575602571084222,0.0552625390165215,0.0532444334550913,0.0514626538841487,0.0498826121127696,0.0484763497307141,0.0472210338753393,0.0460978455951617,0.0450911463192070,0.0441878445800334,0.0433769090946243,0.0426489902784185,0.0419961231055100,0.0414114917026062,0.0408892412968263,0.0404243268511034,0.0400123903905180,0.0396496609647768,0.0393328726203420,0.0390591968172183,0.0388261865220709,0.0386317298128490,0.0384740112913428,0.0383514799556953,0.0382628224613703,0.0382069409158723,0.0381829345240146,0.0381900845374687,0.0382278420727674,0.0382958184520641,0.0383937777954654,0.0385216316563779,0.0386794355449425,0.0388673872316326,0.0390858267654184,0.0393352381802069,0.0396162529010377,0.0399296548991214,0.0402763876835932,0.0406575632592047,0.0410744732246036,0.0415286022370334,0.0420216441282206,0.0425555210252939,0.0431324059127212,0.0437547491701334,0.0444253097411598,0.0451471917359691,0.0459238874527617,0.0467593280309787,0.0476579432346195,0.0486247322251615,0.0496653476433593,0.0507861959089002,0.0519945574088935,0.0532987312385516,0.0547082104604735,0.0562338955748138,0.0578883561995849,0.0596861540743485,0.0616442447479884,0.0637824811697624,0.0661242505810418,0.0686972876701054,0.0715347235367107,0.0746764541585347,0.0781709477896475,0.0820776645795125,0.0864703444875176,0.0914415496235020,0.0971090564503069,0.103625039313556,0.111189576340373,0.120071048081667,0.130637903856678,0.143409919783391,0.159144434293917,0.178988827558487,0.204766866525229,0.239557887248881,0.288982845039466,0.364419136001721,0.492267467115397,0.741342978598707,1];
%
semilogy(rho_sim,OP_N_non_sim,'bs--',rho_sim,OP_F_non_sim,'ro--');
hold on
semilogy(rho_sim,OP_N_sim,'bs');
hold on 
semilogy(rho_sim,OP_F_sim,'ro');
hold on 
semilogy(rho_ana,OP_F_approx,'r:')
hold on 
semilogy(rho_ana,OP_N_exact,'b-')
hold on
semilogy(rho_ana,OP_F_exact,'r-')
hold on
%
legend('User N, non-coop (sim.)', 'User F, non-coop (sim.)', ...
    'User N, SWIPT NOMA (sim.)','User F, SWIPT NOMA (sim.)', ...
    'User F, SWIPT NOMA (approx.)', 'SWIPT NOMA (exact)', ...
    'location','southeast')
xlabel('\rho')
ylabel('Outage Probability (OP)')
xticks([0:.2:1])
axis([0 1 5e-3 1])